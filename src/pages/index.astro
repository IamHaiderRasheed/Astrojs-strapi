---
// src/pages/[slug].astro

import Layout from "../../src/layouts/layout.astro";
import Postcard from "../../src/components/postcard.astro";
import Container from "../../src/components/container.astro";

// Fetch data from Strapi at build time
let posts = [];
try {
  const response = await fetch("http://localhost:1337/api/posts?populate[image]=true&populate[categories]=true");
  const result = await response.json();
  posts = result.data; // assuming `result.data` contains an array of posts
} catch (error) {
  console.error("Error fetching posts:", error);
}
---

<Layout>
  <Container>
    <main>
      <div class="grid gap-10 lg:gap-7 md:grid-cols-2">
        <!-- Dynamically render Postcard components for each post -->
        {
          posts
            .slice(0, 2)
            .map((post) => (
              <Postcard post={post} aspect="landscape" preloadImage={true} />
            ))
        }
      </div>
      <div class="grid gap-10 mt-10 lg:gap-10 md:grid-cols-2 xl:grid-cols-3">
        {
          posts
            .slice(2)
            .map((post) => <Postcard post={post} aspect="square" preloadImage={true} />)
        }
      </div>
    </main>
  </Container>
</Layout>


